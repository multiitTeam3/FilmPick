<!DOCTYPE html><html layout:decorate="~{layout}"><head>
    <meta charset="UTF-8">
    <title>결제 페이지</title>
    <style>
        .small-text {
            font-size: 0.8em; /* 폰트 크기 줄이기 */
            color: rgba(0, 0, 0, 0.6); /* 텍스트 반투명하게 */
        }
    </style></head><body><div layout:fragment="content">
    <div class="container">
        <div class="row">
            <div class="col-md-12 p-4">
                <h2 class="font-weight-bold mb-4">결제 정보</h2>
                <div th:if="${reservations != null && !reservations.isEmpty()}">
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <img th:src="@{${reservations[0].posterPath}}" alt="Movie Poster" class="img-fluid rounded">
                        </div>
                        <div class="col-md-4">
                            <h2 class="font-weight-bold mb-4">영화정보</h2>
                            <p><strong>사용자:</strong> <span th:text="${username}"></span></p>
                            <p><strong>예약번호:</strong> <span th:text="${rsvNoList}"></span></p>
                            <p><strong>영화명:</strong> <span th:text="${reservations[0].movieTitle}"></span></p>
                            <p><strong>일시:</strong> <span th:text="${reservations[0].date}"></span></p>
                            <p><strong>상영 시간:</strong> <span th:text="${reservations[0].startTime} + ' - ' + ${reservations[0].endTime}"></span></p>
                            <p><strong>영화관:</strong> <span th:text="${reservations[0].cinemaName}"></span></p>
                            <p><strong>상영관:</strong> <span th:text="${reservations[0].screenName}"></span></p>
                            <p><strong>좌석:</strong>
                                <span th:text="${seatNames}"></span>
                            </p>
                            <p><strong>인원:</strong> 성인 <span th:text="${adultCount}"></span>명 청소년 <span th:text="${teenCount}"></span>명</p>
                        </div>
                    </div>
                </div>

                <form id="kakaopay" th:object="${kakaoReadyDTO}" method="post" th:action="@{/payment/kakaoPay}">
                    <div class="mb-4">
                        <div class="d-flex justify-content-between mb-2">
                            <span>사용할 포인트:</span>
                            <input type="number" name="pointsToUse" min="0" max="${userPoints}" class="form-control">
                            <p class="small-text">1000원이상부터 사용가능합니다</p>
                        </div>
                        <span>결제방식 선택</span>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payMethod" id="kakao" value="kakao">
                            <label class="form-check-label" for="kakao">카카오 페이</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payMethod" id="card" value="card">
                            <label class="form-check-label" for="card">카드 결제</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="payMethod" id="nobank" value="nobank">
                            <label class="form-check-label" for="nobank">무통장 입금</label>
                        </div>
                        <div class="d-flex justify-content-between mb-2">
                            <span>상품금액</span>
                            <span th:text="${totalPrice}"></span> 원
                        </div>
                        <input type="hidden" name="posterPath" th:field="*{posterPath}">
                        <input type="hidden" name="memberNo" th:field="*{memberNo}">
                        <input type="hidden" name="username" th:field="*{username}">
                        <input type="hidden" name="rsvNoList" th:field="*{rsvNoList}">
                        <input type="hidden" name="movieTitle" th:field="*{movieTitle}">
                        <input type="hidden" name="totalPrice" th:field="*{totalPrice}">
                        <input type="hidden" name="adultCount" th:field="*{adultCount}">
                        <input type="hidden" name="teenCount" th:field="*{teenCount}">
                        <button type="submit" class="btn btn-primary" id="payButton">결제하기</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
<script>
    document.getElementById('payButton').addEventListener('click', function() {
      const selectedMethod = document.querySelector('input[name="payMethod"]:checked').value;
      if (selectedMethod === 'kakao') {
          document.getElementById('paymentForm').submit();
      } else {
          alert('미구현상태입니다.');
      }
  });
</script></body></html>